import random


class GameEngine:
    SCENES = {
        "start": {
            "text": "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ó–æ–Ω—É, —Å—Ç–∞–ª–∫–µ—Ä. –í–≤–µ–¥–∏ —Å–≤–æ—ë –∏–º—è:",
            "actions": []
        },
        "sidorovich": {
            "text": lambda user_name: (
                f" *–ë—É–Ω–∫–µ—Ä –°–∏–¥–æ—Ä–æ–≤–∏—á–∞*\n\n"
                f""
                f"–ö–æ—Ä–æ—á–µ, –ú–µ—á–µ–Ω—ã–π, —è —Ç–µ–±—è —Å–ø–∞—Å –∏ –≤ –±–ª–∞–≥–æ—Ä–æ–¥—Å—Ç–≤–æ –∏–≥—Ä–∞—Ç—å –Ω–µ –±—É–¥—É: –≤—ã–ø–æ–ª–Ω–∏—à—å –¥–ª—è –º–µ–Ω—è –ø–∞—Ä—É –∑–∞–¥–∞–Ω–∏–π ‚Äî –∏ –º—ã –≤ —Ä–∞—Å—á–µ—Ç–µ."
                f" –ó–∞–æ–¥–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –±—ã—Å—Ç—Ä–æ —É —Ç–µ–±—è –±–∞—à–∫–∞ –ø–æ—Å–ª–µ –∞–º–Ω–µ–∑–∏–∏ –ø—Ä–æ—è—Å–Ω–∏—Ç—Å—è. \n\n"
                f"*–ó–∞–¥–∞–Ω–∏–µ:*\n"
                f"–ù—É–∂–Ω–æ –ø—Ä–∏–Ω–µ—Å—Ç–∏ –∫–æ–µ-–∫–∞–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏–∑ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏ x18, —á—Ç–æ —Ç–µ–±—è —Ç–∞–º –∂–¥–µ—Ç —è –Ω–µ –∑–Ω–∞—é.\n"
                f"–ò –≤–æ—Ç —á—Ç–æ, –±—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–µ–Ω\n\n"
                f"*–ü—Ä–∏–Ω–µ—Å–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã*"
            ),
            "actions": ["shop", "give_doc", "street"]
        },
        "street": {
            "text": lambda user_name: (
                f"üå´Ô∏è *–£–ª–∏—Ü—ã –ü—Ä–∏–ø—è—Ç–∏*\n\n"
                f"–í—ã –≤—ã—à–ª–∏ –Ω–∞ —É–ª–∏—Ü—É –∏ –æ–∫–∞–∑–∞–ª–∏—Å—å —Å—Ä–µ–¥–∏ –º—ë—Ä—Ç–≤—ã—Ö –¥–æ–º–æ–≤. "
                f"–í–µ—Ç–µ—Ä —à–µ–ø—á–µ—Ç —Å—Ç–∞—Ä—ã–µ —Å–µ–∫—Ä–µ—Ç—ã. –ù–∞–ø—Ä–æ—Ç–∏–≤ ‚Äî –∑–∞–±—Ä–æ—à–µ–Ω–Ω—ã–π –¥–æ–º, "
                f"–≥–¥–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–ª—é—á –æ—Ç –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏.\n\n"
                f"–í—ã –≤–∏–¥–∏—Ç–µ –µ—â—ë –æ–¥–Ω–æ–≥–æ —Å—Ç–∞–ª–∫–µ—Ä–∞, —Å–∏–¥—è—â–µ–≥–æ —É –∫–æ—Å—Ç—Ä–∞\n\n"
                f"*–ö—É–¥–∞ –ø–æ–π–¥—ë—à—å?*"
            ),
            "actions": ["talk_stalker", "search_house", "lab_x18", "to_sidr"]
        },
        "house": {
            "text": "üèöÔ∏è *–ó–∞–±—Ä–æ—à–µ–Ω–Ω—ã–π –¥–æ–º*\n\n–í—ã –≤ —Å—Ç–∞—Ä–æ–º –¥–æ–º–µ. –ü–∞—Ö–Ω–µ—Ç –ø–ª–µ—Å–µ–Ω—å—é –∏ –ø—ã–ª—å—é. –°—Ç–∞—Ä–∞—è –º–µ–±–µ–ª—å —Ä–∞–∑–±—Ä–æ—Å–∞–Ω–∞ –ø–æ –∫–æ–º–Ω–∞—Ç–∞–º.\n\n*–ß—Ç–æ –±—É–¥–µ—à—å –¥–µ–ª–∞—Ç—å?*",
            "actions": ["search", "back"]
        },
        "lab_x18": {
            "text": lambda user_name: (
                f"‚ò¢Ô∏è *–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è X18*\n\n"
                f"–ü–µ—Ä–µ–¥ –≤–∞–º–∏ –º–∞—Å—Å–∏–≤–Ω–æ–π –¥–≤–µ—Ä—å—é –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏. "
                f"–ù–∞ –Ω–µ–π –≤–∏–¥–Ω—ã —Å–ª–µ–¥—ã –æ—Ç –ø—É–ª—å –∏ —Ü–∞—Ä–∞–ø–∏–Ω—ã. "
                f"–¢–∞–±–ª–∏—á–∫–∞ 'X18' –µ–¥–≤–∞ —á–∏—Ç–∞–µ—Ç—Å—è –ø–æ–¥ —Å–ª–æ–µ–º —Ä–∂–∞–≤—á–∏–Ω—ã.\n\n"
            ),
            "actions": ["try_door", "back"]
        },
        "lab_x18_in": {
            "text": "–í—ã –≤–Ω—É—Ç—Ä–∏ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏ X18. –¢–µ–º–Ω–æ. –í –≤–æ–∑–¥—É—Ö–µ –≤–∏—Å–∏—Ç –∑–∞–ø–∞—Ö –æ–∫–∏—Å–ª–µ–Ω–Ω–æ–≥–æ –º–µ—Ç–∞–ª–ª–∞.  \n" 
                "–ü–æ—Å–ª—ã—à–∞–ª—Å—è —à–æ—Ä–æ—Ö, –≤–æ–∑–º–æ–∂–Ω–æ –≥–¥–µ-—Ç–æ —Ä—è–¥–æ–º –º—É—Ç–∞–Ω—Ç...\n"
                "–¢—ã —É–≤–∏–¥–µ–ª –≤–¥–∞–ª–∏ –∫–æ–º–Ω–∞—Ç—É, –≤ –∫–æ—Ç–æ—Ä–æ–π –º–µ—Ä—Ü–∞–µ—Ç —Å–≤–µ—Ç –æ—Ç –ª–∞–º–ø.\n"
                "–¢–∞–º –º–æ–≥—É—Ç –±—ã—Ç—å –º—É—Ç–∞–Ω—Ç—ã, –∞ –±–µ–∑ –æ—Ä—É–∂–∏—è –∏—Ö –Ω–µ –æ–¥–æ–ª–µ—Ç—å\n\n"
                "*–†–µ—à–∏—à—å—Å—è –ª–∏ —Ç—ã –∏–¥—Ç–∏ —Ç—É–¥–∞?*",
            "actions": ["go_room", "back"]
        },
        "shop": {
            "text": lambda user_name: (
                f"*–ú–∞–≥–∞–∑–∏–Ω*\n\n"
                f"'{random.choice([
                    f'–ù—É! –ß—ë —Å—Ç–æ–∏—à—å? –ü–æ–¥—Ö–æ–¥–∏, –Ω–µ –∫—É—Å–∞—é—Å—å',
                    f'–≠–π! –ò–¥–∏ —Å—é–¥–∞, –ø–æ–¥–∫–∏–Ω—É —Ç–µ–±–µ –∫–æ–µ-—á–µ–≥–æ!',
                    f'–ó–¥–∞—Ä–æ–≤–∞, —Ä–∞–¥ —Ç–µ–±—è –≤–∏–¥–µ—Ç—å! –ù—É —á—ë, –¥–∞–≤–∞–π –æ –¥–µ–ª–µ –ø–æ–≥–æ–≤–æ—Ä–∏–º?'
                ])}"
            ),
            "actions": ["buy", "back"]
        },
        "room": {
            "text": "",
            "actions": ["search_doc", "back"]
        },

        "end": {
            "text": "",
            "actions": ["menu", "back"]
        }

    }

    ITEMS = {
        "key_x18": {
            "name": "üîë –ö–ª—é—á –æ—Ç X18",
            "description": "–†–∂–∞–≤—ã–π –∫–ª—é—á —Å –≥—Ä–∞–≤–∏—Ä–æ–≤–∫–æ–π 'X18'"
        },
        "pistol": {
            "name": " –ü–∏—Å—Ç–æ–ª–µ—Ç –ü–ú",
            "description": "9-–º–º –ø–∏—Å—Ç–æ–ª–µ—Ç, –Ω–µ —Å–∞–º—ã–π –º–æ—â–Ω—ã–π, –Ω–æ –ª—É—á—à–µ, —á–µ–º –Ω–∏—á–µ–≥–æ",
            "price": 1000
        },
        "documents": {
            "name": " –î–æ–∫—É–º–µ–Ω—Ç—ã X18",
            "description": "–ó–∞–ø–µ—á–∞—Ç–∞–Ω–Ω–∞—è –ø–∞–ø–∫–∞ —Å –≥—Ä–∏—Ñ–æ–º '–°–æ–≤–µ—Ä—à–µ–Ω–Ω–æ —Å–µ–∫—Ä–µ—Ç–Ω–æ'"
        }
    }

    SIDOROVICH_SHOP = {
        "pistol": 1000
    }

    @staticmethod
    def get_scene_text(scene_id, user_name=""):
        scene = GameEngine.SCENES.get(scene_id, {})
        text_template = scene.get("text", "–°—Ü–µ–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.")

        # –ï—Å–ª–∏ —Ç–µ–∫—Å—Ç - —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã–∑—ã–≤–∞–µ–º –µ—ë —Å –∏–º–µ–Ω–µ–º
        if callable(text_template):
            return text_template(user_name or "–°—Ç–∞–ª–∫–µ—Ä")
        return text_template

    @staticmethod
    def get_scene_actions(scene_id):
        return GameEngine.SCENES.get(scene_id, {}).get("actions", [])